{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 1,
   "id": "e87144b8-7ec7-4330-8c1f-7703a3d0c3da",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "/Users/mehuljayaswal/Desktop/Hybrid/Random_4_1878/New_Tableau_data/%_of_total\n"
     ]
    }
   ],
   "source": [
    "cd /Users/mehuljayaswal/Desktop/Hybrid/Random_4_1878/New_Tableau_data/%_of_total"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "id": "5e1a50bf-25ca-475f-b938-e6f9b173e58c",
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "/Users/mehuljayaswal/opt/anaconda3/lib/python3.8/site-packages/IPython/core/interactiveshell.py:3165: DtypeWarning: Columns (3,4,5,6,7,8,9,10,11,12,13,14,15,16) have mixed types.Specify dtype option on import or set low_memory=False.\n",
      "  has_raised = await self.run_ast_nodes(code_ast.body, cell_name,\n"
     ]
    }
   ],
   "source": [
    "import pandas as pd\n",
    "import numpy as np\n",
    "import matplotlib\n",
    "#matplotlib.use('Agg')\n",
    "import matplotlib.pyplot as plt\n",
    "import seaborn as sns\n",
    "import csv\n",
    "import glob\n",
    "from textwrap import wrap\n",
    "import os\n",
    "\n",
    "app='ref'\n",
    "\n",
    "dfd=pd.read_csv('disagg_v2.csv')\n",
    "#print(dfd)\n",
    "dfx=pd.read_csv('itemization_all_v1.csv')\n",
    "dfx=dfd.merge(dfx,how='left',on=['uuid','epoch'])\n",
    "#print(dfx)\n",
    "\n",
    "dfy=pd.read_csv('itemization_v2.csv')\n",
    "#print(dfy)\n",
    "dfz=dfx.merge(dfy,how='left',on=['uuid','epoch'])\n",
    "df_meta=pd.read_csv('meta_data.csv')\n",
    "dfz=dfz.merge(df_meta,how='left',on=['uuid'])\n",
    "\n",
    "\n",
    "app1=app+'_disagg'\n",
    "app2=app+'_v1'\n",
    "app3=app+'_v2'\n",
    "\n",
    "\n",
    "dfz[app1] = pd.to_numeric(dfz[app1], errors='coerce')\n",
    "dfz[app2] = pd.to_numeric(dfz[app2], errors='coerce')\n",
    "dfz[app3] = pd.to_numeric(dfz[app3], errors='coerce')\n",
    "\n",
    "dfz=dfz[['uuid','date','epoch','uuid-epoch','pilotid',app1,app2,app3,'days_disagg','va1_disagg','va2_disagg']]\n",
    "\n",
    "dfz['effective_number_of_days']=dfz['days_disagg']-dfz['va1_disagg']-dfz['va2_disagg']\n",
    "\n",
    "dfz.sort_values(by=['uuid-epoch'],inplace=True)\n",
    "\n",
    "dfz=dfz[(dfz[app1]>0) &  (dfz[app2]>0) &  (dfz[app3]>0)]\n",
    "\n",
    "dfz['scaled_output_disagg']=(dfz[app1]/(dfz['effective_number_of_days']))*30\n",
    "dfz['scaled_output_v1']=(dfz[app2]/(dfz['effective_number_of_days']))*30\n",
    "dfz['scaled_output_v2']=(dfz[app3]/(dfz['effective_number_of_days']))*30\n",
    "\n",
    "\n",
    "df_compare=dfz\n",
    "df_compare=df_compare.shift(1)\n",
    "df_compare = df_compare[df_compare['uuid'].notna()]\n",
    "\n",
    "df=pd.DataFrame()\n",
    "df['uuid_1']=dfz['uuid']\n",
    "df['uuid_2']=df_compare['uuid']\n",
    "\n",
    "df['disagg_original']=dfz['scaled_output_disagg']\n",
    "df['disagg_shifted']=df_compare['scaled_output_disagg']\n",
    "\n",
    "df['v1_original']=dfz['scaled_output_v1']\n",
    "df['v1_shifted']=df_compare['scaled_output_v1']\n",
    "\n",
    "df['v2_original']=dfz['scaled_output_v2']\n",
    "df['v2_shifted']=df_compare['scaled_output_v2']\n",
    "\n",
    "df.loc[df['uuid_1']==df['uuid_2'] , 'disagg_delta'] = ((df['disagg_original']-df['disagg_shifted'])/df['disagg_shifted'])*100\n",
    "df.loc[df['uuid_1']==df['uuid_2'] , 'v1_delta'] = ((df['v1_original']-df['v1_shifted'])/df['v1_shifted'])*100\n",
    "df.loc[df['uuid_1']==df['uuid_2'] , 'v2_delta'] = ((df['v2_original']-df['v2_shifted'])/df['v2_shifted'])*100\n",
    "\n",
    "df['disagg_delta'] = df.apply(lambda x: x['disagg_delta'] if x['uuid_1'] ==\n",
    "                     x['uuid_2'] else np.nan, axis=1)\n",
    "df['v1_delta'] = df.apply(lambda x: x['v1_delta'] if x['uuid_1'] ==\n",
    "                     x['uuid_2'] else np.nan, axis=1)\n",
    "df['v2_delta'] = df.apply(lambda x: x['v2_delta'] if x['uuid_1'] ==\n",
    "                     x['uuid_2'] else np.nan, axis=1)\n",
    "df=df.dropna()\n",
    "\n",
    "df.to_csv('m2m_{}.csv'.format(app))\n",
    "#this is for git test \n",
    "\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "id": "008a9b27-89c4-432d-9978-ce4586fcd78c",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "[-100.          -77.77777778  -55.55555556  -33.33333333  -11.11111111\n",
      "   11.11111111   33.33333333   55.55555556   77.77777778  100.        ]\n"
     ]
    },
    {
     "data": {
      "image/png": "iVBORw0KGgoAAAANSUhEUgAAA4AAAANmCAYAAACrKeXIAAAAOXRFWHRTb2Z0d2FyZQBNYXRwbG90bGliIHZlcnNpb24zLjMuNCwgaHR0cHM6Ly9tYXRwbG90bGliLm9yZy8QVMy6AAAACXBIWXMAAAsTAAALEwEAmpwYAAA8t0lEQVR4nO3deZg0ZXkv/u/NorgAImhcUF80GiGaHwJqXIK4EbdgBCPhYDioxyULajyJ0cQgGmNOokaPGpecBFETRYMLRsVdxCVEeMXEuCUuqCAaQRBQWcTn90fVQNPMzDvD2zM98nw+19VXT1dVV939dE13fbueqqrWWgAAALju22beBQAAALA+BEAAAIBOCIAAAACdEAABAAA6IQACAAB0Yrt5FzBru+22W9u0adO8ywAAAJiLzZs3n9tau9li465zAXDTpk05/fTT510GAADAXFTVN5YapwsoAABAJwRAAACATgiAAAAAnbjOHQMIAABsXJdffnnOOuusXHLJJfMu5WfeDjvskN133z3bb7/9ip8jAAIAAOvmrLPOyo477phNmzalquZdzs+s1lrOO++8nHXWWdljjz1W/DxdQAEAgHVzySWXZNdddxX+tlJVZdddd131nlQBEAAAWFfC32xcm3YUAAEAADrhGEAAAGBuNm+e7fz23XfL09z4xjfOxRdffOXj4447Lqeffnpe+cpXLvmcAw44IC9+8Yuz3377LTvv008/PW94wxvy8pe//BrjNm3alNNPPz277bbbFmv81re+lSOOOCLf+c53ss022+RJT3pSnva0p23xeVsiAAIAAMzAT37yk+y3335bDIkrsd122+UlL3lJ9tlnn1x00UXZd9998+AHPzh77bXXVs1XF1AAAIAkF110UfbYY49cfvnlSZILL7wwmzZtuvLxP/zDP+Te97537nKXu+TTn/50kuSYY47Jk570pBx44IE54ogjcvLJJ+cRj3hEkuS8887LgQcemLvd7W558pOfnNbaNZb56le/Os985jOvfHzcccflqKOOyi1vecvss88+SZIdd9wxe+65Z84+++ytfo0CIAAA0JUf//jH2Xvvva+8HX300UmGoHXAAQfkPe95T5Lk+OOPzyGHHHLldfZ++MMf5lOf+lRe9apX5fGPf/yV89u8eXNOPPHEvOlNb7racp73vOflvve9b84444wcdNBB+eY3v3mNWh796Efn7W9/+5WP3/KWt+TQQw+92jRnnnlmzjjjjNzznvfc6tcuAAIAAF25wQ1ukM9+9rNX3p7//OdfOe5//a//lde97nVJkte97nV53OMed+W4ww47LEmy//7758ILL8wFF1yQJDnooINygxvc4BrLOeWUU/LYxz42SfLwhz88u+yyyzWmudnNbpbb3/72OfXUU3Peeefly1/+cu5zn/tcOf7iiy/OIYcckpe97GXZaaedtvq1OwYQAABgdJ/73CdnnnlmPvaxj+WKK67IXe5ylyvHTV92YeHxjW50oyXnt5JLNRx66KF561vfmjvf+c551KMedeVzLr/88hxyyCE5/PDDc/DBB1+bl3MN9gACAABMOOKII3LYYYddbe9fMnTPTJJPfOIT2XnnnbPzzjsvO5/9998///iP/5gkOemkk3L++ecvOt3BBx+cd77znXnzm998ZffP1lqe8IQnZM8998wznvGMrX1JV7IHEAAAmJuVXLZhvR1++OF5znOec2WXzwW77LJL7n3ve+fCCy/Mscceu8X5PPe5z81hhx2WffbZJ/e73/1y29vedtHpdtlll+y11175whe+kHvc4x5Jkk9+8pN54xvfmLve9a7Ze++9kyQvfOEL87CHPWyrXlstdiaan2X77bdfO/300+ddBgAAsIgvfvGL2XPPPeddxrJOOOGEnHjiiXnjG98471K2aLH2rKrNrbVFr0VhDyAAAMDoqKOOykknnZT3vve98y5lTQiAAAAAo1e84hXzLmFNOQkMAACwrq5rh6HNy7VpRwEQAABYNzvssEPOO+88IXArtdZy3nnnZYcddljV83QBBQAA1s3uu++es846K9/73vfmXcrPvB122CG77777qp4jAAIAAOtm++23zx577DHvMrqlCygAAEAnBEAAAIBOCIAAAACdEAABAAA6IQACAAB0QgAEAADohAAIAADQCQEQAACgEwIgAABAJwRAAACATgiAAAAAnRAAAQAAOiEAAgAAdEIABAAA6MR28y4AAFZq8+Z5V3Ddsu++864AgPVmDyAAAEAnBEAAAIBOCIAAAACdEAABAAA6IQACAAB0QgAEAADohAAIAADQCQEQAACgEwIgAABAJwRAAACATgiAAAAAnRAAAQAAOiEAAgAAdEIABAAA6IQACAAA0AkBEAAAoBMCIAAAQCcEQAAAgE4IgAAAAJ0QAAEAADohAAIAAHRCAAQAAOiEAAgAANAJARAAAKATAiAAAEAnBEAAAIBOCIAAAACdEAABAAA6IQACAAB0QgAEAADohAAIAADQCQEQAACgEwIgAABAJwRAAACATgiAAAAAnRAAAQAAOiEAAgAAdEIABAAA6IQACAAA0AkBEAAAoBMCIAAAQCcEQAAAgE4IgAAAAJ0QAAEAADohAAIAAHRCAAQAAOiEAAgAANAJARAAAKATAiAAAEAnBEAAAIBOCIAAAACdEAABAAA6IQACAAB0QgAEAADohAAIAADQCQEQAACgEwIgAABAJwRAAACATgiAAAAAnRAAAQAAOiEAAgAAdEIABAAA6IQACAAA0AkBEAAAoBMCIAAAQCcEQAAAgE4IgAAAAJ0QAAEAADohAAIAAHRCAAQAAOiEAAgAANAJARAAAKATAiAAAEAnBEAAAIBOCIAAAACdEAABAAA6IQACAAB0QgAEAADohAAIAADQCQEQAACgEwIgAABAJwRAAACATgiAAAAAnRAAAQAAOiEAAgAAdEIABAAA6IQACAAA0AkBEAAAoBMCIAAAQCcEQAAAgE4IgAAAAJ0QAAEAADohAAIAAHRCAAQAAOiEAAgAANAJARAAAKATAiAAAEAnBEAAAIBOCIAAAACdEAABAAA6IQACAAB0QgAEAADohAAIAADQCQEQAACgEwIgAABAJwRAAACATgiAAAAAnRAAAQAAOiEAAgAAdEIABAAA6IQACAAA0AkBEAAAoBMCIAAAQCcEQAAAgE4IgAAAAJ0QAAEAADohAAIAAHRCAAQAAOiEAAgAANAJARAAAKATAiAAAEAnBEAAAIBOCIAAAACdEAABAAA6IQACAAB0QgAEAADohAAIAADQCQEQAACgEwIgAABAJwRAAACATgiAAAAAnRAAAQAAOiEAAgAAdEIABAAA6IQACAAA0AkBEAAAoBMCIAAAQCcEQAAAgE4IgAAAAJ0QAAEAADohAAIAAHRCAAQAAOiEAAgAANAJARAAAKATAiAAAEAnBEAAAIBOCIAAAACdEAABAAA6IQACAAB0QgAEAADohAAIAADQCQEQAACgEwIgAABAJwRAAACATgiAAAAAnRAAAQAAOiEAAgAAdEIABAAA6IQACAAA0AkBEAAAoBMCIAAAQCcEQAAAgE4IgAAAAJ0QAAEAADohAAIAAHRCAAQAAOiEAAgAANAJARAAAKATAiAAAEAnBEAAAIBOCIAAAACdEAABAAA6IQACAAB0QgAEAADohAAIAADQCQEQAACgEwIgAABAJwRAAACATgiAAAAAnRAAAQAAOiEAAgAAdEIABAAA6IQACAAA0AkBEAAAoBMCIAAAQCcEQAAAgE4IgAAAAJ0QAAEAADohAAIAAHRCAAQAAOiEAAgAANAJARAAAKATAiAAAEAnBEAAAIBOCIAAAACdEAABAAA6IQACAAB0QgAEAADohAAIAADQCQEQAACgEwIgAABAJwRAAACATgiAAAAAnRAAAQAAOiEAAgAAdEIABAAA6IQACAAA0AkBEAAAoBMCIAAAQCcEQAAAgE4IgAAAAJ0QAAEAADohAAIAAHRCAAQAAOiEAAgAANAJARAAAKATAiAAAEAnBEAAAIBOCIAAAACdEAABAAA6IQACAAB0QgAEAADohAAIAADQCQEQAACgEwIgAABAJwRAAACATgiAAAAAnRAAAQAAOiEAAgAAdEIABAAA6IQACAAA0AkBEAAAoBMCIAAAQCcEQAAAgE4IgAAAAJ0QAAEAADohAAIAAHRCAAQAAOiEAAgAANAJARAAAKATAiAAAEAnBEAAAIBOCIAAAACdEAABAAA6IQACAAB0QgAEAADohAAIAADQCQEQAACgEwIgAABAJwRAAACATgiAAAAAnRAAAQAAOiEAAgAAdEIABAAA6IQACAAA0AkBEAAAoBMCIAAAQCcEQAAAgE4IgAAAAJ0QAAEAADohAAIAAHRCAAQAAOiEAAgAANAJARAAAKATAiAAAEAnBEAAAIBOCIAAAACdEAABAAA6IQACAAB0QgAEAADohAAIAADQCQEQAACgEwIgAABAJwRAAACATgiAAAAAnRAAAQAAOiEAAgAAdEIABAAA6IQACAAA0AkBEAAAoBMCIAAAQCcEQAAAgE4IgAAAAJ0QAAEAADohAAIAAHRCAAQAAOiEAAgAANAJARAAAKATAiAAAEAnBEAAAIBOCIAAAACdEAABAAA6IQACAAB0QgAEAADohAAIAADQCQEQAACgEwIgAABAJwRAAACATgiAAAAAnRAAAQAAOiEAAgAAdEIABAAA6IQACAAA0AkBEAAAoBMCIAAAQCcEQAAAgE4IgAAAAJ0QAAEAADohAAIAAHRCAAQAAOiEAAgAANAJARAAAKAT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gAAAAJ0QAAEAADohAAIAAHRCAAQAAOiEAAgAANAJARAAAKATAiAAAEAnBEAAAIBOCIAAAACdEAABAAA6IQACAAB0QgAEAADohAAIAADQCQEQAACgEwIgAABAJwRAAACATgiAAAAAnRAAAQAAOiEAAgAAdEIABAAA6IQACAAA0AkBEAAAoBMCIAAAQCcEQAAAgE4IgAAAAJ0QAAEAADohAAIAAHRCAAQAAOiEAAgAANAJARAAAKATAiAAAEAnBEAAAIBOCIAAAACdEAABAAA6IQACAAB0QgAEAADohAAIAADQCQEQAACgEwIgAABAJwRAAACATgiAAAAAnRAAAQAAOiEAAgAAdEIABAAA6IQACAAA0AkBEAAAoBMCIAAAQCcEQAAAgE4IgAAAAJ0QAAEAADohAAIAAHRCAAQAAOiEAAgAANAJARAAAKATAiAAAEAnBEAAAIBOCIAAAACdEAABAAA6IQACAAB0QgAEAADohAAIAADQCQEQAACgEwIgAABAJwRAAACATgiAAAAAnRAAAQAAOiEAAgAAdEIABAAA6IQACAAA0AkBEAAAoBMCIAAAQCcEQAAAgE4IgAAAAJ0QAAEAADohAAIAAHRCAAQAAOiEAAgAANAJARAAAKATAiAAAEAnBEAAAIBOCIAAAACdEAABAAA6IQACAAB0QgAEAADohAAIAADQCQEQAACgEwIgAABAJwRAAACATgiAAAAAnRAAAQAAOiEAAgAAdEIABAAA6IQACAAA0AkBEAAAoBMCIAAAQCcEQAAAgE4IgAAAAJ0QAAEAADohAAIAAHRCAAQAAOiEAAgAANAJARAAAKATAiAAAEAnBEAAAIBOCIAAAACdEAABAAA6IQACAAB0QgAEAADohAAIAADQCQEQAACgEwIgAABAJwRAAACATgiAAAAAnRAAAQAAOiEAAgAAdEIABAAA6IQACAAA0AkBEAAAoBMCIAAAQCcEQAAAgE4IgAAAAJ0QAAEAADohAAIAAHRCAAQAAOiEAAgAANAJARAAAKATAiAAAEAnBEAAAIBOCIAAAACdEAABAAA6IQACAAB0QgAEAADohAAIAADQCQEQAACgEwIgAABAJwRAAACATgiAAAAAnRAAAQAAOiEAAgAAdEIABAAA6IQACAAA0AkBEAAAoBMCIAAAQCcEQAAAgE4IgAAAAJ0QAAEAADohAAIAAHRC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\n",
      "text/plain": [
       "<Figure size 1080x1080 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "bins = np.linspace(-100, 100, 10)\n",
    "print(bins)\n",
    "plt.figure(figsize=(15,15))\n",
    "plt.hist(df['v1_delta'], bins, alpha=0.4, label='Hybrid v1', color='green')\n",
    "plt.hist(df['v2_delta'], bins, alpha=0.2, label='Hybrid v2', color='blue')\n",
    "plt.legend(loc='upper right')\n",
    "plt.ylabel('BC Count',fontsize=15)\n",
    "plt.xlabel('Delta from Previous month (Cooking)',fontsize=15)\n",
    "plt.yticks(np.arange(0, 1000, 80))\n",
    "plt.xticks(np.arange(-100, 110, 10), fontsize=15)\n",
    "plt.show()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 30,
   "id": "1a600a28-93e6-48a8-a197-adc4ef5be1a2",
   "metadata": {},
   "outputs": [],
   "source": [
    "dfz['effective_number_of_days']=dfz['days_disagg']-dfz['va1_disagg']-dfz['va2_disagg']"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 31,
   "id": "6520b7e3-7f4d-475d-9922-78674e739d6a",
   "metadata": {},
   "outputs": [],
   "source": [
    "dfz['scaled_output_disagg']=(dfz[app1]/(dfz['effective_number_of_days']))*30\n",
    "dfz['scaled_output_v1']=(dfz[app2]/(dfz['effective_number_of_days']))*30\n",
    "dfz['scaled_output_v2']=(dfz[app2]/(dfz['effective_number_of_days']))*30"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 32,
   "id": "4ef40866-6ebc-4097-8004-647ca6e2ed8a",
   "metadata": {},
   "outputs": [],
   "source": [
    "dfz=dfz[(dfz[app1]>0) &  (dfz[app2]>0) &  (dfz[app3]>0)]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 33,
   "id": "1d4f9985-2a86-4066-8aa4-bd463011f178",
   "metadata": {},
   "outputs": [],
   "source": [
    "dfz.sort_values(by=['uuid-epoch'],inplace=True)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 34,
   "id": "12a03c7c-adaf-4e21-a8c5-a462c305a746",
   "metadata": {},
   "outputs": [],
   "source": [
    "df_compare=dfz\n",
    "df_compare=df_compare.shift(1)\n",
    "df_compare = df_compare[df_compare['uuid'].notna()]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 35,
   "id": "ee86642d-7951-4985-9fe4-8197b19840b4",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>uuid</th>\n",
       "      <th>date</th>\n",
       "      <th>epoch</th>\n",
       "      <th>uuid-epoch</th>\n",
       "      <th>pilotid</th>\n",
       "      <th>ao_disagg</th>\n",
       "      <th>ao_v1</th>\n",
       "      <th>ao_v2</th>\n",
       "      <th>days_disagg</th>\n",
       "      <th>va1_disagg</th>\n",
       "      <th>va2_disagg</th>\n",
       "      <th>effective_number_of_days</th>\n",
       "      <th>scaled_output_disagg</th>\n",
       "      <th>scaled_output_v1</th>\n",
       "      <th>scaled_output_v2</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>434</th>\n",
       "      <td>0001d612-b4dc-4eb0-a83a-a4bb9b6cffc6</td>\n",
       "      <td>12/21/2018</td>\n",
       "      <td>1.545311e+09</td>\n",
       "      <td>0001d612-b4dc-4eb0-a83a-a4bb9b6cffc6-1545310800</td>\n",
       "      <td>Origin</td>\n",
       "      <td>88688.562</td>\n",
       "      <td>87951.7</td>\n",
       "      <td>78117.59953</td>\n",
       "      <td>71.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>71.0</td>\n",
       "      <td>37474.040282</td>\n",
       "      <td>37162.690141</td>\n",
       "      <td>37162.690141</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>435</th>\n",
       "      <td>0001d612-b4dc-4eb0-a83a-a4bb9b6cffc6</td>\n",
       "      <td>03/02/19</td>\n",
       "      <td>1.551445e+09</td>\n",
       "      <td>0001d612-b4dc-4eb0-a83a-a4bb9b6cffc6-1551445200</td>\n",
       "      <td>Origin</td>\n",
       "      <td>110367.200</td>\n",
       "      <td>110367.2</td>\n",
       "      <td>95471.63335</td>\n",
       "      <td>94.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>94.0</td>\n",
       "      <td>35223.574468</td>\n",
       "      <td>35223.574468</td>\n",
       "      <td>35223.574468</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>117504</th>\n",
       "      <td>0001d612-b4dc-4eb0-a83a-a4bb9b6cffc6</td>\n",
       "      <td>06/04/19</td>\n",
       "      <td>1.559570e+09</td>\n",
       "      <td>0001d612-b4dc-4eb0-a83a-a4bb9b6cffc6-1559570400</td>\n",
       "      <td>Origin</td>\n",
       "      <td>103791.600</td>\n",
       "      <td>103791.6</td>\n",
       "      <td>88842.79007</td>\n",
       "      <td>92.0</td>\n",
       "      <td>2.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>90.0</td>\n",
       "      <td>34597.200000</td>\n",
       "      <td>34597.200000</td>\n",
       "      <td>34597.200000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>127413</th>\n",
       "      <td>0001d612-b4dc-4eb0-a83a-a4bb9b6cffc6</td>\n",
       "      <td>09/04/19</td>\n",
       "      <td>1.567519e+09</td>\n",
       "      <td>0001d612-b4dc-4eb0-a83a-a4bb9b6cffc6-1567519200</td>\n",
       "      <td>Origin</td>\n",
       "      <td>102603.300</td>\n",
       "      <td>102603.3</td>\n",
       "      <td>26599.03964</td>\n",
       "      <td>91.0</td>\n",
       "      <td>3.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>88.0</td>\n",
       "      <td>34978.397727</td>\n",
       "      <td>34978.397727</td>\n",
       "      <td>34978.397727</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>159826</th>\n",
       "      <td>0001d612-b4dc-4eb0-a83a-a4bb9b6cffc6</td>\n",
       "      <td>12/04/19</td>\n",
       "      <td>1.575378e+09</td>\n",
       "      <td>0001d612-b4dc-4eb0-a83a-a4bb9b6cffc6-1575378000</td>\n",
       "      <td>Origin</td>\n",
       "      <td>208664.600</td>\n",
       "      <td>208664.6</td>\n",
       "      <td>80770.59359</td>\n",
       "      <td>183.0</td>\n",
       "      <td>9.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>174.0</td>\n",
       "      <td>35976.655172</td>\n",
       "      <td>35976.655172</td>\n",
       "      <td>35976.655172</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>444885</th>\n",
       "      <td>fffee48b-5761-498b-b0a7-94c4b386f607</td>\n",
       "      <td>2/19/2021</td>\n",
       "      <td>1.613722e+09</td>\n",
       "      <td>fffee48b-5761-498b-b0a7-94c4b386f607-1613721600</td>\n",
       "      <td>Marin Clean Energy (MCE)</td>\n",
       "      <td>160495.488</td>\n",
       "      <td>160495.5</td>\n",
       "      <td>164522.77390</td>\n",
       "      <td>29.0</td>\n",
       "      <td>2.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>27.0</td>\n",
       "      <td>178328.320000</td>\n",
       "      <td>178328.333333</td>\n",
       "      <td>178328.333333</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>444886</th>\n",
       "      <td>fffee48b-5761-498b-b0a7-94c4b386f607</td>\n",
       "      <td>3/20/2021</td>\n",
       "      <td>1.616224e+09</td>\n",
       "      <td>fffee48b-5761-498b-b0a7-94c4b386f607-1616223600</td>\n",
       "      <td>Marin Clean Energy (MCE)</td>\n",
       "      <td>270208.980</td>\n",
       "      <td>270209.0</td>\n",
       "      <td>269886.59130</td>\n",
       "      <td>32.0</td>\n",
       "      <td>2.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>30.0</td>\n",
       "      <td>270208.980000</td>\n",
       "      <td>270209.000000</td>\n",
       "      <td>270209.000000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>461258</th>\n",
       "      <td>fffee48b-5761-498b-b0a7-94c4b386f607</td>\n",
       "      <td>4/21/2021</td>\n",
       "      <td>1.618988e+09</td>\n",
       "      <td>fffee48b-5761-498b-b0a7-94c4b386f607-1618988400</td>\n",
       "      <td>Marin Clean Energy (MCE)</td>\n",
       "      <td>229463.040</td>\n",
       "      <td>229463.0</td>\n",
       "      <td>230222.10090</td>\n",
       "      <td>28.0</td>\n",
       "      <td>2.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>26.0</td>\n",
       "      <td>264765.046154</td>\n",
       "      <td>264765.000000</td>\n",
       "      <td>264765.000000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>471639</th>\n",
       "      <td>fffee48b-5761-498b-b0a7-94c4b386f607</td>\n",
       "      <td>5/19/2021</td>\n",
       "      <td>1.621408e+09</td>\n",
       "      <td>fffee48b-5761-498b-b0a7-94c4b386f607-1621407600</td>\n",
       "      <td>Marin Clean Energy (MCE)</td>\n",
       "      <td>251295.840</td>\n",
       "      <td>251295.8</td>\n",
       "      <td>17822.40000</td>\n",
       "      <td>30.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>30.0</td>\n",
       "      <td>251295.840000</td>\n",
       "      <td>251295.800000</td>\n",
       "      <td>251295.800000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>481846</th>\n",
       "      <td>fffee48b-5761-498b-b0a7-94c4b386f607</td>\n",
       "      <td>6/18/2021</td>\n",
       "      <td>1.624000e+09</td>\n",
       "      <td>fffee48b-5761-498b-b0a7-94c4b386f607-1623999600</td>\n",
       "      <td>Marin Clean Energy (MCE)</td>\n",
       "      <td>200993.600</td>\n",
       "      <td>200993.6</td>\n",
       "      <td>16241.90707</td>\n",
       "      <td>32.0</td>\n",
       "      <td>3.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>29.0</td>\n",
       "      <td>207924.413793</td>\n",
       "      <td>207924.413793</td>\n",
       "      <td>207924.413793</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>750107 rows × 15 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "                                        uuid        date         epoch  \\\n",
       "434     0001d612-b4dc-4eb0-a83a-a4bb9b6cffc6  12/21/2018  1.545311e+09   \n",
       "435     0001d612-b4dc-4eb0-a83a-a4bb9b6cffc6    03/02/19  1.551445e+09   \n",
       "117504  0001d612-b4dc-4eb0-a83a-a4bb9b6cffc6    06/04/19  1.559570e+09   \n",
       "127413  0001d612-b4dc-4eb0-a83a-a4bb9b6cffc6    09/04/19  1.567519e+09   \n",
       "159826  0001d612-b4dc-4eb0-a83a-a4bb9b6cffc6    12/04/19  1.575378e+09   \n",
       "...                                      ...         ...           ...   \n",
       "444885  fffee48b-5761-498b-b0a7-94c4b386f607   2/19/2021  1.613722e+09   \n",
       "444886  fffee48b-5761-498b-b0a7-94c4b386f607   3/20/2021  1.616224e+09   \n",
       "461258  fffee48b-5761-498b-b0a7-94c4b386f607   4/21/2021  1.618988e+09   \n",
       "471639  fffee48b-5761-498b-b0a7-94c4b386f607   5/19/2021  1.621408e+09   \n",
       "481846  fffee48b-5761-498b-b0a7-94c4b386f607   6/18/2021  1.624000e+09   \n",
       "\n",
       "                                             uuid-epoch  \\\n",
       "434     0001d612-b4dc-4eb0-a83a-a4bb9b6cffc6-1545310800   \n",
       "435     0001d612-b4dc-4eb0-a83a-a4bb9b6cffc6-1551445200   \n",
       "117504  0001d612-b4dc-4eb0-a83a-a4bb9b6cffc6-1559570400   \n",
       "127413  0001d612-b4dc-4eb0-a83a-a4bb9b6cffc6-1567519200   \n",
       "159826  0001d612-b4dc-4eb0-a83a-a4bb9b6cffc6-1575378000   \n",
       "...                                                 ...   \n",
       "444885  fffee48b-5761-498b-b0a7-94c4b386f607-1613721600   \n",
       "444886  fffee48b-5761-498b-b0a7-94c4b386f607-1616223600   \n",
       "461258  fffee48b-5761-498b-b0a7-94c4b386f607-1618988400   \n",
       "471639  fffee48b-5761-498b-b0a7-94c4b386f607-1621407600   \n",
       "481846  fffee48b-5761-498b-b0a7-94c4b386f607-1623999600   \n",
       "\n",
       "                         pilotid   ao_disagg     ao_v1         ao_v2  \\\n",
       "434                       Origin   88688.562   87951.7   78117.59953   \n",
       "435                       Origin  110367.200  110367.2   95471.63335   \n",
       "117504                    Origin  103791.600  103791.6   88842.79007   \n",
       "127413                    Origin  102603.300  102603.3   26599.03964   \n",
       "159826                    Origin  208664.600  208664.6   80770.59359   \n",
       "...                          ...         ...       ...           ...   \n",
       "444885  Marin Clean Energy (MCE)  160495.488  160495.5  164522.77390   \n",
       "444886  Marin Clean Energy (MCE)  270208.980  270209.0  269886.59130   \n",
       "461258  Marin Clean Energy (MCE)  229463.040  229463.0  230222.10090   \n",
       "471639  Marin Clean Energy (MCE)  251295.840  251295.8   17822.40000   \n",
       "481846  Marin Clean Energy (MCE)  200993.600  200993.6   16241.90707   \n",
       "\n",
       "        days_disagg  va1_disagg  va2_disagg  effective_number_of_days  \\\n",
       "434            71.0         0.0         0.0                      71.0   \n",
       "435            94.0         0.0         0.0                      94.0   \n",
       "117504         92.0         2.0         0.0                      90.0   \n",
       "127413         91.0         3.0         0.0                      88.0   \n",
       "159826        183.0         9.0         0.0                     174.0   \n",
       "...             ...         ...         ...                       ...   \n",
       "444885         29.0         2.0         0.0                      27.0   \n",
       "444886         32.0         2.0         0.0                      30.0   \n",
       "461258         28.0         2.0         0.0                      26.0   \n",
       "471639         30.0         0.0         0.0                      30.0   \n",
       "481846         32.0         3.0         0.0                      29.0   \n",
       "\n",
       "        scaled_output_disagg  scaled_output_v1  scaled_output_v2  \n",
       "434             37474.040282      37162.690141      37162.690141  \n",
       "435             35223.574468      35223.574468      35223.574468  \n",
       "117504          34597.200000      34597.200000      34597.200000  \n",
       "127413          34978.397727      34978.397727      34978.397727  \n",
       "159826          35976.655172      35976.655172      35976.655172  \n",
       "...                      ...               ...               ...  \n",
       "444885         178328.320000     178328.333333     178328.333333  \n",
       "444886         270208.980000     270209.000000     270209.000000  \n",
       "461258         264765.046154     264765.000000     264765.000000  \n",
       "471639         251295.840000     251295.800000     251295.800000  \n",
       "481846         207924.413793     207924.413793     207924.413793  \n",
       "\n",
       "[750107 rows x 15 columns]"
      ]
     },
     "execution_count": 35,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df_compare"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 26,
   "id": "bda8682c-980e-456f-9395-cb4760c336f3",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>uuid</th>\n",
       "      <th>date</th>\n",
       "      <th>epoch</th>\n",
       "      <th>uuid-epoch</th>\n",
       "      <th>pilotid</th>\n",
       "      <th>ao_disagg</th>\n",
       "      <th>ao_v1</th>\n",
       "      <th>ao_v2</th>\n",
       "      <th>days_disagg</th>\n",
       "      <th>va1_disagg</th>\n",
       "      <th>va2_disagg</th>\n",
       "      <th>effective_number_of_days</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>433</th>\n",
       "      <td>0001d612-b4dc-4eb0-a83a-a4bb9b6cffc6</td>\n",
       "      <td>12/21/2018</td>\n",
       "      <td>1545310800</td>\n",
       "      <td>0001d612-b4dc-4eb0-a83a-a4bb9b6cffc6-1545310800</td>\n",
       "      <td>Origin</td>\n",
       "      <td>88688.562</td>\n",
       "      <td>87951.7</td>\n",
       "      <td>78117.59953</td>\n",
       "      <td>71.0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>71.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>434</th>\n",
       "      <td>0001d612-b4dc-4eb0-a83a-a4bb9b6cffc6</td>\n",
       "      <td>03/02/19</td>\n",
       "      <td>1551445200</td>\n",
       "      <td>0001d612-b4dc-4eb0-a83a-a4bb9b6cffc6-1551445200</td>\n",
       "      <td>Origin</td>\n",
       "      <td>110367.200</td>\n",
       "      <td>110367.2</td>\n",
       "      <td>95471.63335</td>\n",
       "      <td>94.0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>94.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>435</th>\n",
       "      <td>0001d612-b4dc-4eb0-a83a-a4bb9b6cffc6</td>\n",
       "      <td>06/04/19</td>\n",
       "      <td>1559570400</td>\n",
       "      <td>0001d612-b4dc-4eb0-a83a-a4bb9b6cffc6-1559570400</td>\n",
       "      <td>Origin</td>\n",
       "      <td>103791.600</td>\n",
       "      <td>103791.6</td>\n",
       "      <td>88842.79007</td>\n",
       "      <td>92.0</td>\n",
       "      <td>2</td>\n",
       "      <td>0</td>\n",
       "      <td>90.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>117504</th>\n",
       "      <td>0001d612-b4dc-4eb0-a83a-a4bb9b6cffc6</td>\n",
       "      <td>09/04/19</td>\n",
       "      <td>1567519200</td>\n",
       "      <td>0001d612-b4dc-4eb0-a83a-a4bb9b6cffc6-1567519200</td>\n",
       "      <td>Origin</td>\n",
       "      <td>102603.300</td>\n",
       "      <td>102603.3</td>\n",
       "      <td>26599.03964</td>\n",
       "      <td>91.0</td>\n",
       "      <td>3</td>\n",
       "      <td>0</td>\n",
       "      <td>88.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>127413</th>\n",
       "      <td>0001d612-b4dc-4eb0-a83a-a4bb9b6cffc6</td>\n",
       "      <td>12/04/19</td>\n",
       "      <td>1575378000</td>\n",
       "      <td>0001d612-b4dc-4eb0-a83a-a4bb9b6cffc6-1575378000</td>\n",
       "      <td>Origin</td>\n",
       "      <td>208664.600</td>\n",
       "      <td>208664.6</td>\n",
       "      <td>80770.59359</td>\n",
       "      <td>183.0</td>\n",
       "      <td>9</td>\n",
       "      <td>0</td>\n",
       "      <td>174.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>444885</th>\n",
       "      <td>fffee48b-5761-498b-b0a7-94c4b386f607</td>\n",
       "      <td>3/20/2021</td>\n",
       "      <td>1616223600</td>\n",
       "      <td>fffee48b-5761-498b-b0a7-94c4b386f607-1616223600</td>\n",
       "      <td>Marin Clean Energy (MCE)</td>\n",
       "      <td>270208.980</td>\n",
       "      <td>270209.0</td>\n",
       "      <td>269886.59130</td>\n",
       "      <td>32.0</td>\n",
       "      <td>2</td>\n",
       "      <td>0</td>\n",
       "      <td>30.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>444886</th>\n",
       "      <td>fffee48b-5761-498b-b0a7-94c4b386f607</td>\n",
       "      <td>4/21/2021</td>\n",
       "      <td>1618988400</td>\n",
       "      <td>fffee48b-5761-498b-b0a7-94c4b386f607-1618988400</td>\n",
       "      <td>Marin Clean Energy (MCE)</td>\n",
       "      <td>229463.040</td>\n",
       "      <td>229463.0</td>\n",
       "      <td>230222.10090</td>\n",
       "      <td>28.0</td>\n",
       "      <td>2</td>\n",
       "      <td>0</td>\n",
       "      <td>26.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>461258</th>\n",
       "      <td>fffee48b-5761-498b-b0a7-94c4b386f607</td>\n",
       "      <td>5/19/2021</td>\n",
       "      <td>1621407600</td>\n",
       "      <td>fffee48b-5761-498b-b0a7-94c4b386f607-1621407600</td>\n",
       "      <td>Marin Clean Energy (MCE)</td>\n",
       "      <td>251295.840</td>\n",
       "      <td>251295.8</td>\n",
       "      <td>17822.40000</td>\n",
       "      <td>30.0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>30.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>471639</th>\n",
       "      <td>fffee48b-5761-498b-b0a7-94c4b386f607</td>\n",
       "      <td>6/18/2021</td>\n",
       "      <td>1623999600</td>\n",
       "      <td>fffee48b-5761-498b-b0a7-94c4b386f607-1623999600</td>\n",
       "      <td>Marin Clean Energy (MCE)</td>\n",
       "      <td>200993.600</td>\n",
       "      <td>200993.6</td>\n",
       "      <td>16241.90707</td>\n",
       "      <td>32.0</td>\n",
       "      <td>3</td>\n",
       "      <td>0</td>\n",
       "      <td>29.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>481846</th>\n",
       "      <td>fffee48b-5761-498b-b0a7-94c4b386f607</td>\n",
       "      <td>7/20/2021</td>\n",
       "      <td>1626764400</td>\n",
       "      <td>fffee48b-5761-498b-b0a7-94c4b386f607-1626764400</td>\n",
       "      <td>Marin Clean Energy (MCE)</td>\n",
       "      <td>174696.160</td>\n",
       "      <td>174696.2</td>\n",
       "      <td>12761.18045</td>\n",
       "      <td>30.0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>30.0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>750108 rows × 12 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "                                        uuid        date       epoch  \\\n",
       "433     0001d612-b4dc-4eb0-a83a-a4bb9b6cffc6  12/21/2018  1545310800   \n",
       "434     0001d612-b4dc-4eb0-a83a-a4bb9b6cffc6    03/02/19  1551445200   \n",
       "435     0001d612-b4dc-4eb0-a83a-a4bb9b6cffc6    06/04/19  1559570400   \n",
       "117504  0001d612-b4dc-4eb0-a83a-a4bb9b6cffc6    09/04/19  1567519200   \n",
       "127413  0001d612-b4dc-4eb0-a83a-a4bb9b6cffc6    12/04/19  1575378000   \n",
       "...                                      ...         ...         ...   \n",
       "444885  fffee48b-5761-498b-b0a7-94c4b386f607   3/20/2021  1616223600   \n",
       "444886  fffee48b-5761-498b-b0a7-94c4b386f607   4/21/2021  1618988400   \n",
       "461258  fffee48b-5761-498b-b0a7-94c4b386f607   5/19/2021  1621407600   \n",
       "471639  fffee48b-5761-498b-b0a7-94c4b386f607   6/18/2021  1623999600   \n",
       "481846  fffee48b-5761-498b-b0a7-94c4b386f607   7/20/2021  1626764400   \n",
       "\n",
       "                                             uuid-epoch  \\\n",
       "433     0001d612-b4dc-4eb0-a83a-a4bb9b6cffc6-1545310800   \n",
       "434     0001d612-b4dc-4eb0-a83a-a4bb9b6cffc6-1551445200   \n",
       "435     0001d612-b4dc-4eb0-a83a-a4bb9b6cffc6-1559570400   \n",
       "117504  0001d612-b4dc-4eb0-a83a-a4bb9b6cffc6-1567519200   \n",
       "127413  0001d612-b4dc-4eb0-a83a-a4bb9b6cffc6-1575378000   \n",
       "...                                                 ...   \n",
       "444885  fffee48b-5761-498b-b0a7-94c4b386f607-1616223600   \n",
       "444886  fffee48b-5761-498b-b0a7-94c4b386f607-1618988400   \n",
       "461258  fffee48b-5761-498b-b0a7-94c4b386f607-1621407600   \n",
       "471639  fffee48b-5761-498b-b0a7-94c4b386f607-1623999600   \n",
       "481846  fffee48b-5761-498b-b0a7-94c4b386f607-1626764400   \n",
       "\n",
       "                         pilotid   ao_disagg     ao_v1         ao_v2  \\\n",
       "433                       Origin   88688.562   87951.7   78117.59953   \n",
       "434                       Origin  110367.200  110367.2   95471.63335   \n",
       "435                       Origin  103791.600  103791.6   88842.79007   \n",
       "117504                    Origin  102603.300  102603.3   26599.03964   \n",
       "127413                    Origin  208664.600  208664.6   80770.59359   \n",
       "...                          ...         ...       ...           ...   \n",
       "444885  Marin Clean Energy (MCE)  270208.980  270209.0  269886.59130   \n",
       "444886  Marin Clean Energy (MCE)  229463.040  229463.0  230222.10090   \n",
       "461258  Marin Clean Energy (MCE)  251295.840  251295.8   17822.40000   \n",
       "471639  Marin Clean Energy (MCE)  200993.600  200993.6   16241.90707   \n",
       "481846  Marin Clean Energy (MCE)  174696.160  174696.2   12761.18045   \n",
       "\n",
       "        days_disagg  va1_disagg  va2_disagg  effective_number_of_days  \n",
       "433            71.0           0           0                      71.0  \n",
       "434            94.0           0           0                      94.0  \n",
       "435            92.0           2           0                      90.0  \n",
       "117504         91.0           3           0                      88.0  \n",
       "127413        183.0           9           0                     174.0  \n",
       "...             ...         ...         ...                       ...  \n",
       "444885         32.0           2           0                      30.0  \n",
       "444886         28.0           2           0                      26.0  \n",
       "461258         30.0           0           0                      30.0  \n",
       "471639         32.0           3           0                      29.0  \n",
       "481846         30.0           0           0                      30.0  \n",
       "\n",
       "[750108 rows x 12 columns]"
      ]
     },
     "execution_count": 26,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "dfz"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 36,
   "id": "60b45e05-1151-4645-8418-5a24c50b1796",
   "metadata": {},
   "outputs": [],
   "source": [
    "df=pd.DataFrame()\n",
    "df['uuid_1']=dfz['uuid']\n",
    "df['uuid_2']=df_compare['uuid']\n",
    "df['disagg_original']=dfz['scaled_output_disagg']\n",
    "df['disagg_shifted']=df_compare['scaled_output_disagg']\n",
    "\n",
    "df['v1_original']=dfz['scaled_output_v1']\n",
    "df['v1_shifted']=df_compare['scaled_output_v1']\n",
    "\n",
    "df['v2_original']=dfz['scaled_output_v2']\n",
    "df['v2_shifted']=df_compare['scaled_output_v2']"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 38,
   "id": "a1f8f287-5bc3-4a6b-ae8e-8531521d6d25",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>uuid_1</th>\n",
       "      <th>uuid_2</th>\n",
       "      <th>disagg_original</th>\n",
       "      <th>disagg_shifted</th>\n",
       "      <th>v1_original</th>\n",
       "      <th>v1_shifted</th>\n",
       "      <th>v2_original</th>\n",
       "      <th>v2_shifted</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>434</th>\n",
       "      <td>0001d612-b4dc-4eb0-a83a-a4bb9b6cffc6</td>\n",
       "      <td>0001d612-b4dc-4eb0-a83a-a4bb9b6cffc6</td>\n",
       "      <td>35223.574468</td>\n",
       "      <td>37474.040282</td>\n",
       "      <td>35223.574468</td>\n",
       "      <td>37162.690141</td>\n",
       "      <td>35223.574468</td>\n",
       "      <td>37162.690141</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>435</th>\n",
       "      <td>0001d612-b4dc-4eb0-a83a-a4bb9b6cffc6</td>\n",
       "      <td>0001d612-b4dc-4eb0-a83a-a4bb9b6cffc6</td>\n",
       "      <td>34597.200000</td>\n",
       "      <td>35223.574468</td>\n",
       "      <td>34597.200000</td>\n",
       "      <td>35223.574468</td>\n",
       "      <td>34597.200000</td>\n",
       "      <td>35223.574468</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>117504</th>\n",
       "      <td>0001d612-b4dc-4eb0-a83a-a4bb9b6cffc6</td>\n",
       "      <td>0001d612-b4dc-4eb0-a83a-a4bb9b6cffc6</td>\n",
       "      <td>34978.397727</td>\n",
       "      <td>34597.200000</td>\n",
       "      <td>34978.397727</td>\n",
       "      <td>34597.200000</td>\n",
       "      <td>34978.397727</td>\n",
       "      <td>34597.200000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>127413</th>\n",
       "      <td>0001d612-b4dc-4eb0-a83a-a4bb9b6cffc6</td>\n",
       "      <td>0001d612-b4dc-4eb0-a83a-a4bb9b6cffc6</td>\n",
       "      <td>35976.655172</td>\n",
       "      <td>34978.397727</td>\n",
       "      <td>35976.655172</td>\n",
       "      <td>34978.397727</td>\n",
       "      <td>35976.655172</td>\n",
       "      <td>34978.397727</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>159826</th>\n",
       "      <td>0003ddcd-b67c-4630-938f-360970bab0b1</td>\n",
       "      <td>0001d612-b4dc-4eb0-a83a-a4bb9b6cffc6</td>\n",
       "      <td>8773.448276</td>\n",
       "      <td>35976.655172</td>\n",
       "      <td>1145.431034</td>\n",
       "      <td>35976.655172</td>\n",
       "      <td>1145.431034</td>\n",
       "      <td>35976.655172</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>444885</th>\n",
       "      <td>fffee48b-5761-498b-b0a7-94c4b386f607</td>\n",
       "      <td>fffee48b-5761-498b-b0a7-94c4b386f607</td>\n",
       "      <td>270208.980000</td>\n",
       "      <td>178328.320000</td>\n",
       "      <td>270209.000000</td>\n",
       "      <td>178328.333333</td>\n",
       "      <td>270209.000000</td>\n",
       "      <td>178328.333333</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>444886</th>\n",
       "      <td>fffee48b-5761-498b-b0a7-94c4b386f607</td>\n",
       "      <td>fffee48b-5761-498b-b0a7-94c4b386f607</td>\n",
       "      <td>264765.046154</td>\n",
       "      <td>270208.980000</td>\n",
       "      <td>264765.000000</td>\n",
       "      <td>270209.000000</td>\n",
       "      <td>264765.000000</td>\n",
       "      <td>270209.000000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>461258</th>\n",
       "      <td>fffee48b-5761-498b-b0a7-94c4b386f607</td>\n",
       "      <td>fffee48b-5761-498b-b0a7-94c4b386f607</td>\n",
       "      <td>251295.840000</td>\n",
       "      <td>264765.046154</td>\n",
       "      <td>251295.800000</td>\n",
       "      <td>264765.000000</td>\n",
       "      <td>251295.800000</td>\n",
       "      <td>264765.000000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>471639</th>\n",
       "      <td>fffee48b-5761-498b-b0a7-94c4b386f607</td>\n",
       "      <td>fffee48b-5761-498b-b0a7-94c4b386f607</td>\n",
       "      <td>207924.413793</td>\n",
       "      <td>251295.840000</td>\n",
       "      <td>207924.413793</td>\n",
       "      <td>251295.800000</td>\n",
       "      <td>207924.413793</td>\n",
       "      <td>251295.800000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>481846</th>\n",
       "      <td>fffee48b-5761-498b-b0a7-94c4b386f607</td>\n",
       "      <td>fffee48b-5761-498b-b0a7-94c4b386f607</td>\n",
       "      <td>174696.160000</td>\n",
       "      <td>207924.413793</td>\n",
       "      <td>174696.200000</td>\n",
       "      <td>207924.413793</td>\n",
       "      <td>174696.200000</td>\n",
       "      <td>207924.413793</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>728215 rows × 8 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "                                      uuid_1  \\\n",
       "434     0001d612-b4dc-4eb0-a83a-a4bb9b6cffc6   \n",
       "435     0001d612-b4dc-4eb0-a83a-a4bb9b6cffc6   \n",
       "117504  0001d612-b4dc-4eb0-a83a-a4bb9b6cffc6   \n",
       "127413  0001d612-b4dc-4eb0-a83a-a4bb9b6cffc6   \n",
       "159826  0003ddcd-b67c-4630-938f-360970bab0b1   \n",
       "...                                      ...   \n",
       "444885  fffee48b-5761-498b-b0a7-94c4b386f607   \n",
       "444886  fffee48b-5761-498b-b0a7-94c4b386f607   \n",
       "461258  fffee48b-5761-498b-b0a7-94c4b386f607   \n",
       "471639  fffee48b-5761-498b-b0a7-94c4b386f607   \n",
       "481846  fffee48b-5761-498b-b0a7-94c4b386f607   \n",
       "\n",
       "                                      uuid_2  disagg_original  disagg_shifted  \\\n",
       "434     0001d612-b4dc-4eb0-a83a-a4bb9b6cffc6     35223.574468    37474.040282   \n",
       "435     0001d612-b4dc-4eb0-a83a-a4bb9b6cffc6     34597.200000    35223.574468   \n",
       "117504  0001d612-b4dc-4eb0-a83a-a4bb9b6cffc6     34978.397727    34597.200000   \n",
       "127413  0001d612-b4dc-4eb0-a83a-a4bb9b6cffc6     35976.655172    34978.397727   \n",
       "159826  0001d612-b4dc-4eb0-a83a-a4bb9b6cffc6      8773.448276    35976.655172   \n",
       "...                                      ...              ...             ...   \n",
       "444885  fffee48b-5761-498b-b0a7-94c4b386f607    270208.980000   178328.320000   \n",
       "444886  fffee48b-5761-498b-b0a7-94c4b386f607    264765.046154   270208.980000   \n",
       "461258  fffee48b-5761-498b-b0a7-94c4b386f607    251295.840000   264765.046154   \n",
       "471639  fffee48b-5761-498b-b0a7-94c4b386f607    207924.413793   251295.840000   \n",
       "481846  fffee48b-5761-498b-b0a7-94c4b386f607    174696.160000   207924.413793   \n",
       "\n",
       "          v1_original     v1_shifted    v2_original     v2_shifted  \n",
       "434      35223.574468   37162.690141   35223.574468   37162.690141  \n",
       "435      34597.200000   35223.574468   34597.200000   35223.574468  \n",
       "117504   34978.397727   34597.200000   34978.397727   34597.200000  \n",
       "127413   35976.655172   34978.397727   35976.655172   34978.397727  \n",
       "159826    1145.431034   35976.655172    1145.431034   35976.655172  \n",
       "...               ...            ...            ...            ...  \n",
       "444885  270209.000000  178328.333333  270209.000000  178328.333333  \n",
       "444886  264765.000000  270209.000000  264765.000000  270209.000000  \n",
       "461258  251295.800000  264765.000000  251295.800000  264765.000000  \n",
       "471639  207924.413793  251295.800000  207924.413793  251295.800000  \n",
       "481846  174696.200000  207924.413793  174696.200000  207924.413793  \n",
       "\n",
       "[728215 rows x 8 columns]"
      ]
     },
     "execution_count": 38,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df.dropna()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 39,
   "id": "8cf2863a-ca75-474e-ac59-2a780bee78f4",
   "metadata": {},
   "outputs": [],
   "source": [
    "df.loc[df['uuid_1']==df['uuid_1'] , 'disagg_delta'] = ((df['disagg_original']-df['disagg_shifted'])/df['disagg_shifted'])*100\n",
    "df.loc[df['uuid_1']==df['uuid_1'] , 'v1_delta'] = ((df['v1_original']-df['v1_shifted'])/df['v1_shifted'])*100\n",
    "df.loc[df['uuid_1']==df['uuid_1'] , 'v2_delta'] = ((df['v2_original']-df['v2_shifted'])/df['v2_shifted'])*100"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 41,
   "id": "44ac9a38-10a9-4c27-8422-6ad4f349a519",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>uuid_1</th>\n",
       "      <th>uuid_2</th>\n",
       "      <th>disagg_original</th>\n",
       "      <th>disagg_shifted</th>\n",
       "      <th>v1_original</th>\n",
       "      <th>v1_shifted</th>\n",
       "      <th>v2_original</th>\n",
       "      <th>v2_shifted</th>\n",
       "      <th>disagg_delta</th>\n",
       "      <th>v1_delta</th>\n",
       "      <th>v2_delta</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>434</th>\n",
       "      <td>0001d612-b4dc-4eb0-a83a-a4bb9b6cffc6</td>\n",
       "      <td>0001d612-b4dc-4eb0-a83a-a4bb9b6cffc6</td>\n",
       "      <td>35223.574468</td>\n",
       "      <td>37474.040282</td>\n",
       "      <td>35223.574468</td>\n",
       "      <td>37162.690141</td>\n",
       "      <td>35223.574468</td>\n",
       "      <td>37162.690141</td>\n",
       "      <td>-6.005399</td>\n",
       "      <td>-5.217910</td>\n",
       "      <td>-5.217910</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>435</th>\n",
       "      <td>0001d612-b4dc-4eb0-a83a-a4bb9b6cffc6</td>\n",
       "      <td>0001d612-b4dc-4eb0-a83a-a4bb9b6cffc6</td>\n",
       "      <td>34597.200000</td>\n",
       "      <td>35223.574468</td>\n",
       "      <td>34597.200000</td>\n",
       "      <td>35223.574468</td>\n",
       "      <td>34597.200000</td>\n",
       "      <td>35223.574468</td>\n",
       "      <td>-1.778282</td>\n",
       "      <td>-1.778282</td>\n",
       "      <td>-1.778282</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>117504</th>\n",
       "      <td>0001d612-b4dc-4eb0-a83a-a4bb9b6cffc6</td>\n",
       "      <td>0001d612-b4dc-4eb0-a83a-a4bb9b6cffc6</td>\n",
       "      <td>34978.397727</td>\n",
       "      <td>34597.200000</td>\n",
       "      <td>34978.397727</td>\n",
       "      <td>34597.200000</td>\n",
       "      <td>34978.397727</td>\n",
       "      <td>34597.200000</td>\n",
       "      <td>1.101817</td>\n",
       "      <td>1.101817</td>\n",
       "      <td>1.101817</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>127413</th>\n",
       "      <td>0001d612-b4dc-4eb0-a83a-a4bb9b6cffc6</td>\n",
       "      <td>0001d612-b4dc-4eb0-a83a-a4bb9b6cffc6</td>\n",
       "      <td>35976.655172</td>\n",
       "      <td>34978.397727</td>\n",
       "      <td>35976.655172</td>\n",
       "      <td>34978.397727</td>\n",
       "      <td>35976.655172</td>\n",
       "      <td>34978.397727</td>\n",
       "      <td>2.853926</td>\n",
       "      <td>2.853926</td>\n",
       "      <td>2.853926</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>159826</th>\n",
       "      <td>0003ddcd-b67c-4630-938f-360970bab0b1</td>\n",
       "      <td>0001d612-b4dc-4eb0-a83a-a4bb9b6cffc6</td>\n",
       "      <td>8773.448276</td>\n",
       "      <td>35976.655172</td>\n",
       "      <td>1145.431034</td>\n",
       "      <td>35976.655172</td>\n",
       "      <td>1145.431034</td>\n",
       "      <td>35976.655172</td>\n",
       "      <td>-75.613496</td>\n",
       "      <td>-96.816183</td>\n",
       "      <td>-96.816183</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>444885</th>\n",
       "      <td>fffee48b-5761-498b-b0a7-94c4b386f607</td>\n",
       "      <td>fffee48b-5761-498b-b0a7-94c4b386f607</td>\n",
       "      <td>270208.980000</td>\n",
       "      <td>178328.320000</td>\n",
       "      <td>270209.000000</td>\n",
       "      <td>178328.333333</td>\n",
       "      <td>270209.000000</td>\n",
       "      <td>178328.333333</td>\n",
       "      <td>51.523314</td>\n",
       "      <td>51.523314</td>\n",
       "      <td>51.523314</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>444886</th>\n",
       "      <td>fffee48b-5761-498b-b0a7-94c4b386f607</td>\n",
       "      <td>fffee48b-5761-498b-b0a7-94c4b386f607</td>\n",
       "      <td>264765.046154</td>\n",
       "      <td>270208.980000</td>\n",
       "      <td>264765.000000</td>\n",
       "      <td>270209.000000</td>\n",
       "      <td>264765.000000</td>\n",
       "      <td>270209.000000</td>\n",
       "      <td>-2.014712</td>\n",
       "      <td>-2.014737</td>\n",
       "      <td>-2.014737</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>461258</th>\n",
       "      <td>fffee48b-5761-498b-b0a7-94c4b386f607</td>\n",
       "      <td>fffee48b-5761-498b-b0a7-94c4b386f607</td>\n",
       "      <td>251295.840000</td>\n",
       "      <td>264765.046154</td>\n",
       "      <td>251295.800000</td>\n",
       "      <td>264765.000000</td>\n",
       "      <td>251295.800000</td>\n",
       "      <td>264765.000000</td>\n",
       "      <td>-5.087230</td>\n",
       "      <td>-5.087228</td>\n",
       "      <td>-5.087228</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>471639</th>\n",
       "      <td>fffee48b-5761-498b-b0a7-94c4b386f607</td>\n",
       "      <td>fffee48b-5761-498b-b0a7-94c4b386f607</td>\n",
       "      <td>207924.413793</td>\n",
       "      <td>251295.840000</td>\n",
       "      <td>207924.413793</td>\n",
       "      <td>251295.800000</td>\n",
       "      <td>207924.413793</td>\n",
       "      <td>251295.800000</td>\n",
       "      <td>-17.259110</td>\n",
       "      <td>-17.259097</td>\n",
       "      <td>-17.259097</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>481846</th>\n",
       "      <td>fffee48b-5761-498b-b0a7-94c4b386f607</td>\n",
       "      <td>fffee48b-5761-498b-b0a7-94c4b386f607</td>\n",
       "      <td>174696.160000</td>\n",
       "      <td>207924.413793</td>\n",
       "      <td>174696.200000</td>\n",
       "      <td>207924.413793</td>\n",
       "      <td>174696.200000</td>\n",
       "      <td>207924.413793</td>\n",
       "      <td>-15.980929</td>\n",
       "      <td>-15.980910</td>\n",
       "      <td>-15.980910</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>725712 rows × 11 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "                                      uuid_1  \\\n",
       "434     0001d612-b4dc-4eb0-a83a-a4bb9b6cffc6   \n",
       "435     0001d612-b4dc-4eb0-a83a-a4bb9b6cffc6   \n",
       "117504  0001d612-b4dc-4eb0-a83a-a4bb9b6cffc6   \n",
       "127413  0001d612-b4dc-4eb0-a83a-a4bb9b6cffc6   \n",
       "159826  0003ddcd-b67c-4630-938f-360970bab0b1   \n",
       "...                                      ...   \n",
       "444885  fffee48b-5761-498b-b0a7-94c4b386f607   \n",
       "444886  fffee48b-5761-498b-b0a7-94c4b386f607   \n",
       "461258  fffee48b-5761-498b-b0a7-94c4b386f607   \n",
       "471639  fffee48b-5761-498b-b0a7-94c4b386f607   \n",
       "481846  fffee48b-5761-498b-b0a7-94c4b386f607   \n",
       "\n",
       "                                      uuid_2  disagg_original  disagg_shifted  \\\n",
       "434     0001d612-b4dc-4eb0-a83a-a4bb9b6cffc6     35223.574468    37474.040282   \n",
       "435     0001d612-b4dc-4eb0-a83a-a4bb9b6cffc6     34597.200000    35223.574468   \n",
       "117504  0001d612-b4dc-4eb0-a83a-a4bb9b6cffc6     34978.397727    34597.200000   \n",
       "127413  0001d612-b4dc-4eb0-a83a-a4bb9b6cffc6     35976.655172    34978.397727   \n",
       "159826  0001d612-b4dc-4eb0-a83a-a4bb9b6cffc6      8773.448276    35976.655172   \n",
       "...                                      ...              ...             ...   \n",
       "444885  fffee48b-5761-498b-b0a7-94c4b386f607    270208.980000   178328.320000   \n",
       "444886  fffee48b-5761-498b-b0a7-94c4b386f607    264765.046154   270208.980000   \n",
       "461258  fffee48b-5761-498b-b0a7-94c4b386f607    251295.840000   264765.046154   \n",
       "471639  fffee48b-5761-498b-b0a7-94c4b386f607    207924.413793   251295.840000   \n",
       "481846  fffee48b-5761-498b-b0a7-94c4b386f607    174696.160000   207924.413793   \n",
       "\n",
       "          v1_original     v1_shifted    v2_original     v2_shifted  \\\n",
       "434      35223.574468   37162.690141   35223.574468   37162.690141   \n",
       "435      34597.200000   35223.574468   34597.200000   35223.574468   \n",
       "117504   34978.397727   34597.200000   34978.397727   34597.200000   \n",
       "127413   35976.655172   34978.397727   35976.655172   34978.397727   \n",
       "159826    1145.431034   35976.655172    1145.431034   35976.655172   \n",
       "...               ...            ...            ...            ...   \n",
       "444885  270209.000000  178328.333333  270209.000000  178328.333333   \n",
       "444886  264765.000000  270209.000000  264765.000000  270209.000000   \n",
       "461258  251295.800000  264765.000000  251295.800000  264765.000000   \n",
       "471639  207924.413793  251295.800000  207924.413793  251295.800000   \n",
       "481846  174696.200000  207924.413793  174696.200000  207924.413793   \n",
       "\n",
       "        disagg_delta   v1_delta   v2_delta  \n",
       "434        -6.005399  -5.217910  -5.217910  \n",
       "435        -1.778282  -1.778282  -1.778282  \n",
       "117504      1.101817   1.101817   1.101817  \n",
       "127413      2.853926   2.853926   2.853926  \n",
       "159826    -75.613496 -96.816183 -96.816183  \n",
       "...              ...        ...        ...  \n",
       "444885     51.523314  51.523314  51.523314  \n",
       "444886     -2.014712  -2.014737  -2.014737  \n",
       "461258     -5.087230  -5.087228  -5.087228  \n",
       "471639    -17.259110 -17.259097 -17.259097  \n",
       "481846    -15.980929 -15.980910 -15.980910  \n",
       "\n",
       "[725712 rows x 11 columns]"
      ]
     },
     "execution_count": 41,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": []
  },
  {
   "cell_type": "code",
   "execution_count": 43,
   "id": "ac4211a1-43ba-472b-b4db-c88bd7e80fdb",
   "metadata": {},
   "outputs": [],
   "source": [
    "df['disagg_delta'] = df.apply(lambda x: x['disagg_delta'] if x['uuid_1'] ==\n",
    "                     x['uuid_2'] else np.nan, axis=1)\n",
    "df['v1_delta'] = df.apply(lambda x: x['v1_delta'] if x['uuid_1'] ==\n",
    "                     x['uuid_2'] else np.nan, axis=1)\n",
    "df['v2_delta'] = df.apply(lambda x: x['v2_delta'] if x['uuid_1'] ==\n",
    "                     x['uuid_2'] else np.nan, axis=1)\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 48,
   "id": "e8a3cbc9-681d-4daf-8384-acf2f0f0806d",
   "metadata": {},
   "outputs": [],
   "source": [
    "df=df.dropna()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 49,
   "id": "0bd1e5aa-ed59-46ca-8f33-280410098817",
   "metadata": {},
   "outputs": [],
   "source": [
    "df.to_csv('m2m_{}.csv'.format(app))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 52,
   "id": "78bda46d-a36b-4405-869a-5b1baceddf9c",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "[-100.          -77.77777778  -55.55555556  -33.33333333  -11.11111111\n",
      "   11.11111111   33.33333333   55.55555556   77.77777778  100.        ]\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "<ipython-input-52-2f8adfa61ef2>:12: UserWarning: Matplotlib is currently using agg, which is a non-GUI backend, so cannot show the figure.\n",
      "  plt.show()\n"
     ]
    }
   ],
   "source": [
    "df \n",
    "bins = np.linspace(-100, 100, 10)\n",
    "print(bins)\n",
    "plt.figure(figsize=(15,15))\n",
    "plt.hist(df['v1_delta'], bins, alpha=0.4, label='Hybrid v1', color='green')\n",
    "plt.hist(df['v2_delta'], bins, alpha=0.2, label='Hybrid v2', color='blue')\n",
    "plt.legend(loc='upper right')\n",
    "plt.ylabel('BC Count',fontsize=15)\n",
    "plt.xlabel('Delta from Previous month (Cooking)',fontsize=15)\n",
    "plt.yticks(np.arange(0, 1000, 80))\n",
    "plt.xticks(np.arange(-100, 110, 10), fontsize=15)\n",
    "plt.show()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "e6ed3e49-47a7-4ff0-a48a-b90003259f2b",
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.8.8"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
